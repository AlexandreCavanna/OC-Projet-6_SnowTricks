{% extends 'base.html.twig' %}

{% block title %}Trick : {{ trick.name }}{% endblock %}

{% block body %}
    <div class="container mt-4">
        <div class="card">
            <img src="{{ 'trick-placeholder' in trick.coverImage ? asset('uploads/placeholder/') ~ trick.coverImage : asset('uploads/coverImages/') ~ trick.coverImage }}"
                 class="card-img-top" alt="...">
            <div class="card-body">
                <h5 class="card-title">{{ trick.name }} | {{ trick.label }}</h5>
                <p class="card-text">{{ trick.description }}</p>
            </div>
        </div>
        <div id="carouselIndicators" class="carousel slide mb-4" data-bs-interval="false" data-bs-ride="carousel">
            <div class="carousel-inner">
                {% for picture in trick.pictures %}
                    <div class="carousel-item {% if loop.index == 1 %}active{% endif %}">
                        <img src="{{ asset('uploads/pictures/') }}{{ picture.name }}" class="d-block w-100" alt="...">
                    </div>
                {% endfor %}

                {% for video in trick.videos %}
                    <div class="carousel-item ratio ratio-16x9 {% if loop.index == 1 and trick.pictures is empty %}active{% endif %}">
                        <iframe class="embed-responsive-item" src="{{ video.link }}?rel=0" title="YouTube video player"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowFullScreen></iframe>
                    </div>
                {% endfor %}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselIndicators"
                    data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselIndicators"
                    data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
        {% include 'trick/_comments.html.twig' %}

        <h3 class="mb-4">Tous les commentaires</h3>

        <div id="comment-container">
            {% if trick.getComments() | length == 0 %}
                <div class="alert alert-danger py-4 my-4">
                    Il n'y a encore aucun commentaire sur ce trick !
                </div>
            {% else %}
                <div id="container-pagination">
                    {{ include('partials/_load_more_comments.html.twig') }}
                </div>
            {% endif %}
        </div>
        {% if comments  | length == 10 %}
            <div class="d-flex justify-content-center py-4">
                <a class="btn btn-primary" id="load-more" data-next-page="{{ nextPage }}"
                   href="{{ path('comment_pagination', {'id': trick.id}) }}">
                    <span role="status" aria-hidden="true"></span>
                    Afficher plus
                </a>
            </div>
        {% endif %}
    </div>
{% endblock %}

{% block javascripts %}
    {{ encore_entry_script_tags('toast') }}
    {{ encore_entry_script_tags('ajaxPagination') }}
{% endblock %}
